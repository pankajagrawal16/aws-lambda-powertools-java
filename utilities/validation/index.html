
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Utility">
      
      
      
        <meta name="author" content="Amazon Web Services">
      
      
      <link rel="shortcut icon" href="../../media/aws-logo-light.svg">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.4">
    
    
      
        <title>Validation - Lambda Powertools Java</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.77f3fd56.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#install" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Lambda Powertools Java" class="md-header__button md-logo" aria-label="Lambda Powertools Java">
      
  <img src="../../media/aws-logo-light.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lambda Powertools Java
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Validation
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/awslabs/aws-lambda-powertools-java/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Lambda Powertools Java" class="md-nav__button md-logo" aria-label="Lambda Powertools Java">
      
  <img src="../../media/aws-logo-light.svg" alt="logo">

    </a>
    Lambda Powertools Java
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/awslabs/aws-lambda-powertools-java/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Homepage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Core utilities
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Core utilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Core utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/logging/" class="md-nav__link">
        Logging
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/tracing/" class="md-nav__link">
        Tracing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Utilities
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sqs_large_message_handling/" class="md-nav__link">
        SQS Large Message Handling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        SQS Batch Processing
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Validation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Validation
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    Install
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validating-events" class="md-nav__link">
    Validating events
  </a>
  
    <nav class="md-nav" aria-label="Validating events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-annotation" class="md-nav__link">
    Validation annotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-function" class="md-nav__link">
    Validate function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#built-in-events-and-responses" class="md-nav__link">
    Built-in events and responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-events-and-responses" class="md-nav__link">
    Custom events and responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jmespath-functions" class="md-nav__link">
    JMESPath functions
  </a>
  
    <nav class="md-nav" aria-label="JMESPath functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#powertools_base64-function" class="md-nav__link">
    powertools_base64 function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powertools_base64_gzip-function" class="md-nav__link">
    powertools_base64_gzip function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bring-your-own-jmespath-function" class="md-nav__link">
    Bring your own JMESPath function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-the-schema-version" class="md-nav__link">
    Change the schema version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-objectmapper-settings" class="md-nav__link">
    Advanced ObjectMapper settings
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    Install
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validating-events" class="md-nav__link">
    Validating events
  </a>
  
    <nav class="md-nav" aria-label="Validating events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-annotation" class="md-nav__link">
    Validation annotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-function" class="md-nav__link">
    Validate function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#built-in-events-and-responses" class="md-nav__link">
    Built-in events and responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-events-and-responses" class="md-nav__link">
    Custom events and responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jmespath-functions" class="md-nav__link">
    JMESPath functions
  </a>
  
    <nav class="md-nav" aria-label="JMESPath functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#powertools_base64-function" class="md-nav__link">
    powertools_base64 function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powertools_base64_gzip-function" class="md-nav__link">
    powertools_base64_gzip function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bring-your-own-jmespath-function" class="md-nav__link">
    Bring your own JMESPath function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-the-schema-version" class="md-nav__link">
    Change the schema version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-objectmapper-settings" class="md-nav__link">
    Advanced ObjectMapper settings
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/awslabs/aws-lambda-powertools-java/edit/develop/docs/utilities/validation.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Validation</h1>
                
                <p>This utility provides JSON Schema validation for payloads held within events and response used in AWS Lambda.</p>
<p><strong>Key features</strong></p>
<ul>
<li>Validate incoming events and responses</li>
<li>Built-in validation for most common events (API Gateway, SNS, SQS, ...)</li>
<li>JMESPath support validate only a sub part of the event</li>
</ul>
<h2 id="install">Install<a class="headerlink" href="#install" title="Permanent link">&para;</a></h2>
<p>To install this utility, add the following dependency to your project.</p>
<div class="tabbed-set" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Maven</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.amazonaws<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>powertools-validation<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.2.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Maven Configuration</label><div class="tabbed-content">
<p>Configure the aspectj-maven-plugin to compile-time weave (CTW) the
aws-lambda-powertools-java aspects into your project. You may already have this
plugin in your pom. In that case add the dependency to the <code>aspectLibraries</code>
section.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        ...
        <span class="nt">&lt;plugin&gt;</span>
             <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
             <span class="nt">&lt;artifactId&gt;</span>aspectj-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
             <span class="nt">&lt;version&gt;</span>1.11<span class="nt">&lt;/version&gt;</span>
             <span class="nt">&lt;configuration&gt;</span>
                 <span class="nt">&lt;source&gt;</span>1.8<span class="nt">&lt;/source&gt;</span>
                 <span class="nt">&lt;target&gt;</span>1.8<span class="nt">&lt;/target&gt;</span>
                 <span class="nt">&lt;complianceLevel&gt;</span>1.8<span class="nt">&lt;/complianceLevel&gt;</span>
                 <span class="nt">&lt;aspectLibraries&gt;</span>
<span class="hll">                     <span class="nt">&lt;aspectLibrary&gt;</span>
</span><span class="hll">                         <span class="nt">&lt;groupId&gt;</span>software.amazon.lambda<span class="nt">&lt;/groupId&gt;</span>
</span><span class="hll">                         <span class="nt">&lt;artifactId&gt;</span>powertools-validation<span class="nt">&lt;/artifactId&gt;</span>
</span><span class="hll">                     <span class="nt">&lt;/aspectLibrary&gt;</span>
</span>                 <span class="nt">&lt;/aspectLibraries&gt;</span>
             <span class="nt">&lt;/configuration&gt;</span>
             <span class="nt">&lt;executions&gt;</span>
                 <span class="nt">&lt;execution&gt;</span>
                     <span class="nt">&lt;goals&gt;</span>
                         <span class="nt">&lt;goal&gt;</span>compile<span class="nt">&lt;/goal&gt;</span>
                     <span class="nt">&lt;/goals&gt;</span>
                 <span class="nt">&lt;/execution&gt;</span>
             <span class="nt">&lt;/executions&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        ...
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><label for="__tabbed_1_3">Gradle</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code> <span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">&#39;software.amazon.lambda:powertools-validation:1.2.0&#39;</span>
    <span class="n">aspectpath</span> <span class="s1">&#39;software.amazon.lambda:powertools-validation:1.2.0&#39;</span>
<span class="o">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<h2 id="validating-events">Validating events<a class="headerlink" href="#validating-events" title="Permanent link">&para;</a></h2>
<p>You can validate inbound and outbound events using <code>@Validation</code> annotation.</p>
<p>You can also use the <code>Validator#validate()</code> methods, if you want more control over the validation process such as handling a validation error.</p>
<p>We support JSON schema version 4, 6, 7 and 201909 (from <a href="https://github.com/burtcorp/jmespath-java">jmespath-jackson library</a>).</p>
<h3 id="validation-annotation">Validation annotation<a class="headerlink" href="#validation-annotation" title="Permanent link">&para;</a></h3>
<p><code>@Validation</code> annotation is used to validate either inbound events or functions' response.</p>
<p>It will fail fast with <code>ValidationException</code> if an event or response doesn't conform with given JSON Schema.</p>
<p>While it is easier to specify a json schema file in the classpath (using the notation <code>"classpath:/path/to/schema.json"</code>), you can also provide a JSON String containing the schema.</p>
<div class="tabbed-set" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">MyFunctionHandler.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.Validation</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFunctionHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">APIGatewayProxyRequestEvent</span><span class="p">,</span> <span class="n">APIGatewayProxyResponseEvent</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
<span class="hll">    <span class="nd">@Validation</span><span class="p">(</span><span class="n">inboundSchema</span> <span class="o">=</span> <span class="s">&quot;classpath:/schema_in.json&quot;</span><span class="p">,</span> <span class="n">outboundSchema</span> <span class="o">=</span> <span class="s">&quot;classpath:/schema_out.json&quot;</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">APIGatewayProxyResponseEvent</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">APIGatewayProxyRequestEvent</span> <span class="n">input</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="k">return</span> <span class="n">something</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<p><strong>NOTE</strong>: It's not a requirement to validate both inbound and outbound schemas - You can either use one, or both.</p>
<h3 id="validate-function">Validate function<a class="headerlink" href="#validate-function" title="Permanent link">&para;</a></h3>
<p>Validate standalone function is used within the Lambda handler, or any other methods that perform data validation.</p>
<p>You can also gracefully handle schema validation errors by catching <code>ValidationException</code>.</p>
<div class="tabbed-set" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">MyFunctionHandler.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import static</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationUtils.*</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFunctionHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">APIGatewayProxyRequestEvent</span><span class="p">,</span> <span class="n">APIGatewayProxyResponseEvent</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">APIGatewayProxyResponseEvent</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">APIGatewayProxyRequestEvent</span> <span class="n">input</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
<span class="hll">            <span class="n">validate</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">);</span>
</span>        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ValidationException</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// do something before throwing it</span>
            <span class="k">throw</span> <span class="n">ex</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// ...</span>
        <span class="k">return</span> <span class="n">something</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<p><strong>NOTE</strong>: Schemas are stored in memory for reuse, to avoid loading them from file each time.</p>
<h2 id="built-in-events-and-responses">Built-in events and responses<a class="headerlink" href="#built-in-events-and-responses" title="Permanent link">&para;</a></h2>
<p>For the following events and responses, the Validator will automatically perform validation on the content.</p>
<p><strong> Events </strong></p>
<table>
<thead>
<tr>
<th>Type of event</th>
<th>Class</th>
<th>Path to content</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway REST</td>
<td>APIGatewayProxyRequestEvent</td>
<td><code>body</code></td>
</tr>
<tr>
<td>API Gateway HTTP</td>
<td>APIGatewayV2HTTPEvent</td>
<td><code>body</code></td>
</tr>
<tr>
<td>Application Load Balancer</td>
<td>ApplicationLoadBalancerRequestEvent</td>
<td><code>body</code></td>
</tr>
<tr>
<td>Cloudformation Custom Resource</td>
<td>CloudFormationCustomResourceEvent</td>
<td><code>resourceProperties</code></td>
</tr>
<tr>
<td>CloudWatch Logs</td>
<td>CloudWatchLogsEvent</td>
<td><code>awslogs.powertools_base64_gzip(data)</code></td>
</tr>
<tr>
<td>EventBridge / Cloudwatch</td>
<td>ScheduledEvent</td>
<td><code>detail</code></td>
</tr>
<tr>
<td>Kafka</td>
<td>KafkaEvent</td>
<td><code>records[*][*].value</code></td>
</tr>
<tr>
<td>Kinesis</td>
<td>KinesisEvent</td>
<td><code>Records[*].kinesis.powertools_base64(data)</code></td>
</tr>
<tr>
<td>Kinesis Firehose</td>
<td>KinesisFirehoseEvent</td>
<td><code>Records[*].powertools_base64(data)</code></td>
</tr>
<tr>
<td>Kinesis Analytics from Firehose</td>
<td>KinesisAnalyticsFirehoseInputPreprocessingEvent</td>
<td><code>Records[*].powertools_base64(data)</code></td>
</tr>
<tr>
<td>Kinesis Analytics from Streams</td>
<td>KinesisAnalyticsStreamsInputPreprocessingEvent</td>
<td><code>Records[*].powertools_base64(data)</code></td>
</tr>
<tr>
<td>SNS</td>
<td>SNSEvent</td>
<td><code>Records[*].Sns.Message</code></td>
</tr>
<tr>
<td>SQS</td>
<td>SQSEvent</td>
<td><code>Records[*].body</code></td>
</tr>
</tbody>
</table>
<p><strong> Responses </strong></p>
<table>
<thead>
<tr>
<th>Type of response</th>
<th>Class</th>
<th>Path to content (envelope)</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway REST</td>
<td>APIGatewayProxyResponseEvent}</td>
<td><code>body</code></td>
</tr>
<tr>
<td>API Gateway HTTP</td>
<td>APIGatewayV2HTTPResponse}</td>
<td><code>body</code></td>
</tr>
<tr>
<td>API Gateway WebSocket</td>
<td>APIGatewayV2WebSocketResponse}</td>
<td><code>body</code></td>
</tr>
<tr>
<td>Load Balancer</td>
<td>ApplicationLoadBalancerResponseEvent}</td>
<td><code>body</code></td>
</tr>
<tr>
<td>Kinesis Analytics</td>
<td>KinesisAnalyticsInputPreprocessingResponse}</td>
<td>`Records[*].powertools_base64(data)``</td>
</tr>
</tbody>
</table>
<h2 id="custom-events-and-responses">Custom events and responses<a class="headerlink" href="#custom-events-and-responses" title="Permanent link">&para;</a></h2>
<p>You can also validate any Event or Response type, once you have the appropriate schema.</p>
<p>Sometimes, you might want to validate only a portion of it - This is where the envelope parameter is for.</p>
<p>Envelopes are <a href="https://jmespath.org/tutorial.html">JMESPath expressions</a> to extract a portion of JSON you want before applying JSON Schema validation.</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">MyCustomEventHandler.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.Validation</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyCustomEvent</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
<span class="hll">    <span class="nd">@Validation</span><span class="p">(</span><span class="n">inboundSchema</span> <span class="o">=</span> <span class="s">&quot;classpath:/my_custom_event_schema.json&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="n">envelope</span> <span class="o">=</span> <span class="s">&quot;basket.products[*]&quot;</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyCustomEvent</span> <span class="n">input</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">my_custom_event_schema.json</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">&quot;basket&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;products&quot;</span> <span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">43242</span><span class="p">,</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;FooBar XY&quot;</span><span class="p">,</span>
        <span class="nt">&quot;price&quot;</span><span class="p">:</span> <span class="mi">258</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">765</span><span class="p">,</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;BarBaz AB&quot;</span><span class="p">,</span>
        <span class="nt">&quot;price&quot;</span><span class="p">:</span> <span class="mf">43.99</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<p>This is quite powerful because you can use JMESPath Query language to extract records from
<a href="https://jmespath.org/tutorial.html#list-and-slice-projections">arrays, slice and dice</a>,
to <a href="https://jmespath.org/tutorial.html#pipe-expressions">pipe expressions</a>
and <a href="https://jmespath.org/tutorial.html#functions">function</a> expressions, where you'd extract what you need before validating the actual payload.</p>
<h2 id="jmespath-functions">JMESPath functions<a class="headerlink" href="#jmespath-functions" title="Permanent link">&para;</a></h2>
<p>JMESPath functions ensure to make an operation on a specific part of the json.validate</p>
<p>Powertools provides two built-in functions:</p>
<h3 id="powertools_base64-function">powertools_base64 function<a class="headerlink" href="#powertools_base64-function" title="Permanent link">&para;</a></h3>
<p>Use <code>powertools_base64</code> function to decode any base64 data.</p>
<p>Below sample will decode the base64 value within the data key, and decode the JSON string into a valid JSON before we can validate it.</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">MyEventHandler.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationUtils</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEvent</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="n">validate</span><span class="p">(</span><span class="n">myEvent</span><span class="p">,</span> <span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="s">&quot;powertools_base64(data)&quot;</span><span class="p">);</span>
</span>        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">schema.json</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;data&quot;</span> <span class="p">:</span> <span class="s2">&quot;ewogICJpZCI6IDQzMjQyLAogICJuYW1lIjogIkZvb0JhciBYWSIsCiAgInByaWNlIjogMjU4Cn0=&quot;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<h3 id="powertools_base64_gzip-function">powertools_base64_gzip function<a class="headerlink" href="#powertools_base64_gzip-function" title="Permanent link">&para;</a></h3>
<p>Use <code>powertools_base64_gzip</code> function to decompress and decode base64 data.</p>
<p>Below sample will decompress and decode base64 data.</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">MyEventHandler.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationUtils</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEvent</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEvent</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="n">validate</span><span class="p">(</span><span class="n">myEvent</span><span class="p">,</span> <span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="s">&quot;powertools_base64_gzip(data)&quot;</span><span class="p">);</span>
</span>        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">schema.json</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">{</span>
   <span class="nt">&quot;data&quot;</span> <span class="p">:</span> <span class="s2">&quot;H4sIAAAAAAAA/6vmUlBQykxRslIwMTYyMdIBcfMSc1OBAkpu+flOiUUKEZFKYOGCosxkkLiRqQVXLQDnWo6bOAAAAA==&quot;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You don't need any function to transform a JSON String into a JSON object, powertools-validation will do it for you.
In the 2 previous example, data contains JSON. Just provide the function to transform the base64 / gzipped / ... string into a clear JSON string.</p>
</div>
<h3 id="bring-your-own-jmespath-function">Bring your own JMESPath function<a class="headerlink" href="#bring-your-own-jmespath-function" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This should only be used for advanced use cases where you have special formats not covered by the built-in functions.
New functions will be added to the 2 built-in ones.</p>
</div>
<p>Your function must extend <code>io.burt.jmespath.function.BaseFunction</code>, take a String as parameter and return a String.
You can read the <a href="https://github.com/burtcorp/jmespath-java#adding-custom-functions">doc</a> for more information.</p>
<p>Below is an example that takes some xml and transform it into json. Once your function is created, you need to add it 
to powertools.You can then use it to do your validation or using annotation.</p>
<div class="tabbed-set" data-tabs="7:3"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">XMLFunction.java</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XMLFunction</span> <span class="kd">extends</span> <span class="n">BaseFunction</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="nf">Base64Function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="s">&quot;powertools_xml&quot;</span><span class="p">,</span> <span class="n">ArgumentConstraints</span><span class="p">.</span><span class="na">typeOf</span><span class="p">(</span><span class="n">JmesPathType</span><span class="p">.</span><span class="na">STRING</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">callFunction</span><span class="p">(</span><span class="n">Adapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">runtime</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">FunctionArgument</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">arguments</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">T</span> <span class="n">value</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">value</span><span class="p">();</span>
        <span class="n">String</span> <span class="n">xmlString</span> <span class="o">=</span> <span class="n">runtime</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">jsonString</span> <span class="o">=</span>  <span class="c1">// ... transform xmlString to json</span>

        <span class="k">return</span> <span class="n">runtime</span><span class="p">.</span><span class="na">createString</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Handler with validation API</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationConfig</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationUtils.validate</span><span class="p">;</span>

<span class="kd">static</span> <span class="p">{</span>
<span class="hll">    <span class="n">ValidationConfig</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">addFunction</span><span class="p">(</span><span class="k">new</span> <span class="n">XMLFunction</span><span class="p">());</span>
</span><span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyXMLEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEventWithXML</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEventWithXML</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="n">validate</span><span class="p">(</span><span class="n">myEvent</span><span class="p">,</span> <span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="s">&quot;powertools_xml(path.to.xml_data)&quot;</span><span class="p">);</span>
</span>        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
<input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><label for="__tabbed_7_3">Handler with validation annotation</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationConfig</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.Validation</span><span class="p">;</span>

<span class="kd">static</span> <span class="p">{</span>
<span class="hll">    <span class="n">ValidationConfig</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">addFunction</span><span class="p">(</span><span class="k">new</span> <span class="n">XMLFunction</span><span class="p">());</span>
</span><span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyXMLEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEventWithXML</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
<span class="hll">    <span class="nd">@Validation</span><span class="p">(</span><span class="n">inboundSchema</span><span class="o">=</span><span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="n">envelope</span><span class="o">=</span><span class="s">&quot;powertools_xml(path.to.xml_data)&quot;</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEventWithXML</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<h2 id="change-the-schema-version">Change the schema version<a class="headerlink" href="#change-the-schema-version" title="Permanent link">&para;</a></h2>
<p>By default, powertools-validation is configured with <a href="https://json-schema.org/draft-07/json-schema-release-notes.html">V7</a>.
You can use the <code>ValidationConfig</code> to change that behaviour.</p>
<div class="tabbed-set" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Handler with custom schema version</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationConfig</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.Validation</span><span class="p">;</span>

<span class="kd">static</span> <span class="p">{</span>
<span class="hll">    <span class="n">ValidationConfig</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">setSchemaVersion</span><span class="p">(</span><span class="n">SpecVersion</span><span class="p">.</span><span class="na">VersionFlag</span><span class="p">.</span><span class="na">V4</span><span class="p">);</span>
</span><span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyXMLEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEventWithXML</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="nd">@Validation</span><span class="p">(</span><span class="n">inboundSchema</span><span class="o">=</span><span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="n">envelope</span><span class="o">=</span><span class="s">&quot;powertools_xml(path.to.xml_data)&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEventWithXML</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
<h2 id="advanced-objectmapper-settings">Advanced ObjectMapper settings<a class="headerlink" href="#advanced-objectmapper-settings" title="Permanent link">&para;</a></h2>
<p>If you need to configure the Jackson ObjectMapper, you can use the <code>ValidationConfig</code>:</p>
<div class="tabbed-set" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><label for="__tabbed_9_1">Handler with custom ObjectMapper</label><div class="tabbed-content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.ValidationConfig</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">software.amazon.lambda.powertools.validation.Validation</span><span class="p">;</span>

<span class="kd">static</span> <span class="p">{</span>
<span class="hll">    <span class="n">ObjectMapper</span> <span class="n">objectMapper</span><span class="o">=</span> <span class="n">ValidationConfig</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">getObjectMapper</span><span class="p">();</span>
</span><span class="hll">    <span class="c1">// update (de)serializationConfig or other properties</span>
</span><span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyXMLEventHandler</span> <span class="kd">implements</span> <span class="n">RequestHandler</span><span class="o">&lt;</span><span class="n">MyEventWithXML</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="nd">@Validation</span><span class="p">(</span><span class="n">inboundSchema</span><span class="o">=</span><span class="s">&quot;classpath:/schema.json&quot;</span><span class="p">,</span> <span class="n">envelope</span><span class="o">=</span><span class="s">&quot;powertools_xml(path.to.xml_data)&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">MyEventWithXML</span> <span class="n">myEvent</span><span class="p">,</span> <span class="n">Context</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;OK&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
</div>
</div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: 2021-03-04
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../batch/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              SQS Batch Processing
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Amazon Web Services
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.9b151c6a.min.js"></script>
      
        <script src="../../javascript/aws-amplify.min.js"></script>
      
        <script src="../../javascript/extra.js"></script>
      
    
  </body>
</html>